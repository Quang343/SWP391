
<!DOCTYPE html>
<html lang="en" dir="ltr" xmlns:th="http://www.thymeleaf.org">

<head th:replace="BackEnd/fragments/Admin/head::head"></head>

<style>
    .tracking-wrapper {
        background-color: #f8f9fa;
        padding: 50px 0;
    }

    .tracking-input {
        border-color: #198754 !important; /* Màu viền xanh */
    }

    .tracking-btn {
        border-color: #198754;
        background-color: #198754;
        color: white;
    }

    /*.tracking-btn:hover {*/
    /*    background-color: #198754;*/
    /*    color: white;*/
    /*}*/

     #custom-toast-container {
         position: fixed;
         top: 32px;
         right: 32px;
         z-index: 999999;
     }

    .custom-toast {
        display: flex;
        align-items: center;
        background-color: #fff;
        border-radius: 2px;
        padding: 20px 0;
        min-width: 400px;
        max-width: 450px;
        border-left: 4px solid;
        box-shadow: 0 5px 8px rgba(0, 0, 0, 0.08);
        transition: all linear 0.3s;
    }

    @keyframes custom-slideInLeft {
        from {
            opacity: 0;
            transform: translateX(calc(100% + 32px));
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    @keyframes custom-fadeOut {
        to {
            opacity: 0;
        }
    }

    .custom-toast--success {
        border-color: #47d864;
    }

    .custom-toast--success .custom-toast__icon {
        color: #47d864;
    }

    .custom-toast--info {
        border-color: #2f86eb;
    }

    .custom-toast--info .custom-toast__icon {
        color: #2f86eb;
    }

    .custom-toast--warning {
        border-color: #ffc021;
    }

    .custom-toast--warning .custom-toast__icon {
        color: #ffc021;
    }

    .custom-toast--error {
        border-color: #ff623d;
    }

    .custom-toast--error .custom-toast__icon {
        color: #ff623d;
    }

    .custom-toast + .custom-toast {
        margin-top: 16px;
    }

    .custom-toast__icon {
        font-size: 24px;
        padding: 0 16px;
    }

    .custom-toast__close {
        font-size: 20px;
        color: rgba(0, 0, 0, 0.3);
        padding: 0 16px;
        cursor: pointer;
    }

    .custom-toast__body {
        flex-grow: 1;
    }

    .custom-toast__title {
        font-size: 16px;
        font-weight: 600;
        color: #333;
    }

    .custom-toast__msg {
        font-size: 14px;
        color: #888;
        margin-top: 6px;
        line-height: 1.5;
    }

    button.disabled {
        opacity: 0.6;
        cursor: not-allowed;
    }

    a.disabled {
        pointer-events: none; /* Không cho click */
        text-decoration: none;
        cursor: default;
    }
</style>
<body>
<!-- tap on top start-->
<div class="tap-top">
    <span class="lnr lnr-chevron-up"></span>
</div>
<!-- tap on tap end-->

<!-- page-wrapper Start-->
<div class="page-wrapper compact-wrapper" id="pageWrapper">
    <!-- Page Header Start-->
    <div th:replace="BackEnd/fragments/Admin/header::header"></div>
    <!-- Page Header Ends-->

    <!-- Page Body Start-->
    <div class="page-body-wrapper">
        <!-- Page Sidebar Start-->
        <div th:replace="BackEnd/fragments/Admin/sidebar::sidebar"></div>
        <!-- Page Sidebar Ends-->

        <!-- Order Tracking Seation starts-->
        <div class="page-body">
            <div class="container-fluid">
                <!-- Order Tracking Section -->
                <section class="tracking-wrapper text-center">
                    <div class="container">
                        <h2 class="mb-4 fw-bold">Order Tracking</h2>
                        <div class="row justify-content-center">
                            <div class="col-md-6">
                                <form id="search-form" class="input-group">
                                    <input type="text" class="form-control tracking-input" placeholder="Nhập mã đơn hàng...">
                                    <button class="btn tracking-btn" type="submit">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 16 16">
                                            <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85Zm-5.242.656a5 5 0 1 1 0-10 5 5 0 0 1 0 10Z"/>
                                        </svg>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
            <!-- Container-fluid Ends-->

            <!-- footer start-->
            <div class="container-fluid">
                <footer class="footer">
                    <div class="row">
                        <div class="col-md-12 footer-copyright text-center">
                            <p class="mb-0">Copyright 2022 © Fastkart theme by pixelstrap</p>
                        </div>
                    </div>
                </footer>
            </div>
            <!-- footer end-->
        </div>
        <!-- Order Tracking Seation End-->
    </div>
    <!-- Page Body End-->
</div>
<!-- page-wrapper End-->

<!-- Toast Container -->
<div id="custom-toast-container"></div>
<!-- Modal Start -->
<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog  modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-body">
                <h5 class="modal-title" id="staticBackdropLabel">Logging Out</h5>
                <p>Are you sure you want to log out?</p>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                <div class="button-box">
                    <button type="button" class="btn btn--no" data-bs-dismiss="modal">No</button>
                    <button type="button" th:onclick="|window.location='@{backend/login}'|" class="btn btn--yes btn-primary">Yes</button>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Modal End -->

<!-- latest js -->
<script th:src="@{/Backend/assets/js/jquery-3.6.0.min.js}"></script>

<!-- Bootstrap js -->
<script th:src="@{/Backend/assets/js/bootstrap/bootstrap.bundle.min.js}"></script>

<!-- feather icon js -->
<script th:src="@{/Backend/assets/js/icons/feather-icon/feather.min.js}"></script>
<script th:src="@{/Backend/assets/js/icons/feather-icon/feather-icon.js}"></script>

<!-- scrollbar simplebar js -->
<script th:src="@{/Backend/assets/js/scrollbar/simplebar.js}"></script>
<script th:src="@{/Backend/assets/js/scrollbar/custom.js}"></script>

<!-- Sidebar js -->
<script th:src="@{/Backend/assets/js/config.js}"></script>

<!-- customizer js -->
<script th:src="@{/Backend/assets/js/customizer.js}"></script>

<!-- Plugins js -->

<!-- Data table js -->
<script th:src="@{/Backend/assets/js/jquery.dataTables.js}"></script>
<script th:src="@{/Backend/assets/js/custom-data-table.js}"></script>

<!-- sidebar effect -->
<script th:src="@{/Backend/assets/js/sidebareffect.js}"></script>

<!-- Theme js -->
<script th:src="@{/Backend/assets/js/script.js}"></script>

<!-- bootstrap tag-input js -->
<script th:src="@{/Backend/assets/js/bootstrap-tagsinput.min.js}"></script>

<!-- customizer js -->
<script th:src="@{/Backend/assets/js/sidebar-menu.js}"></script>

<!--Dropzon js -->
<script th:src="@{/Backend/assets/js/dropzone/dropzone.js}"></script>
<script th:src="@{/Backend/assets/js/dropzone/dropzone-script.js}"></script>

<script>
    document.getElementById('search-form').addEventListener("submit", async function(e){
        e.preventDefault();

        const code = document.querySelector('.tracking-input').value;

        fetch(`/AgriculturalWarehouseManagementApplication/admin/orders/order_tracking/${encodeURIComponent(code)}`, {
            method: "POST",
        })
            .then(async res => {
                if (!res.ok) {
                    const contentType = res.headers.get("content-type");
                    if (contentType && contentType.includes("application/json")) {
                        const errorData = await res.json();
                        customToast({
                            title: "Thất bại!",
                            message: errorData.error || "Mã đơn hàng không tồn tại!",
                            type: "error",
                            duration: 3000
                        });
                    } else {
                        const errorText = await res.text();
                        customToast({
                            title: "Thất bại!",
                            message: errorText || "Lỗi không xác định!",
                            type: "error",
                            duration: 3000
                        });
                    }
                }else{
                    window.location.href = `/AgriculturalWarehouseManagementApplication/admin/orders/order_tracking/${code}`;
                }
            })
    })
</script>

<script>
    function customToast({ title = "", message = "", type = "info", duration = 3000 }) {
        const main = document.getElementById("custom-toast-container");
        if (main) {
            const toast = document.createElement("div");

            const autoRemoveId = setTimeout(function () {
                main.removeChild(toast);
            }, duration + 1000);

            toast.onclick = function (e) {
                if (e.target.closest(".custom-toast__close")) {
                    main.removeChild(toast);
                    clearTimeout(autoRemoveId);
                }
            };

            const icons = {
                success: "fas fa-check-circle",
                info: "fas fa-info-circle",
                warning: "fas fa-exclamation-circle",
                error: "fas fa-exclamation-circle"
            };
            const icon = icons[type];
            const delay = (duration / 1000).toFixed(2);

            toast.classList.add("custom-toast", `custom-toast--${type}`);
            toast.style.animation = `custom-slideInLeft ease .3s, custom-fadeOut linear 1s ${delay}s forwards`;

            toast.innerHTML = `
                <div class="custom-toast__icon">
                    <i class="${icon}"></i>
                </div>
                <div class="custom-toast__body">
                    <h3 class="custom-toast__title">${title}</h3>
                    <p class="custom-toast__msg">${message}</p>
                </div>
                <div class="custom-toast__close">
                    <i class="fas fa-times"></i>
                </div>
            `;
            main.appendChild(toast);
        }
    }

</script>

</body>

</html>